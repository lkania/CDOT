source("./cdot/Requirements.R")
# Load necessary libraries
library(colorBlindness)
library(ggplot2)

# Load the R50 and JSD values calculated for the geodesic using R50JSDPlot.ipynb
load("./cdot/PythonR50JSDPlotData.RData")

# The JSD and R50 values for MoDe, Disco, Planing and Adversary are extracted
# from Figure 7 in Kitouni et al. (2021)

CDOT = as.matrix(R50JSDPython[, 2:3])
Mode = matrix(c(2.054899095681104, 10414.635944056585,
                4.339699081942078, 9457.667980971291,
                5.377300839583278, 6195.266604844741,
                7.387014998674995, 4826.939809179237,
                9.433671871515301, 3219.490270240689,
                10.949086414417199, 926.6935996654337,
                12.331690374834494, 249.44098998909544,
                14.102345485453926, 86.17625097422186,
                16.00077353577406, 42.85940651653578,
                17.651899122157353, 17.873870047979295,
                19.45995491405118, 14.083271619419193,
                21.370290120042352, 9.221421781756813,
                24.277467973877723, 4.3260569417867565,
                25.236451972921714, 4.087753591079131,
                26.277259503243577, 3.5346513911263937,
                27.972502627946465, 2.5358390443889447), ncol = 2, byrow = T)

Disco = matrix(c(3.5970284109218578, 6361.0880045630065,
                 4.899488054322581, 7848.525697062727,
                 5.4066107612350525, 7472.737474994792,
                 8.741224972492132, 1364.9058751937957,
                 8.906093281783363, 1361.390775577177,
                 10.976106498439929, 529.1206948104846,
                 12.323294303527994, 202.32245403346772,
                 14.085705998682865, 55.649169108056284,
                 15.942001036628575, 30.24459958751604,
                 18.93191835679343, 9.309241017674628,
                 19.31081015647939, 8.452666022876983,
                 22.07479683057849, 5.720511493155931,
                 23.772329792910423, 5.030970343596969,
                 24.56995656702772, 4.683135352310666,
                 26.335879346547127, 3.7441012832900498,
                 27.968686231898058, 2.5310717722954976), ncol = 2, byrow = T)

Planing = matrix(c(11.45162944607158, 136.84946263032427), ncol = 2, byrow = T)

Adversary = matrix(c(11.962415893190524, 1851.110979892527,
                     13.101839097403252, 943.3098953607782,
                     14.430402889775086, 216.457852558541,
                     15.717138981456369, 75.48822969060065,
                     16.833969121062523, 47.45336909515373,
                     17.571907460982715, 32.45025175513628,
                     18.72110063907937, 21.37545715122799,
                     19.98875475051861, 18.32671594603571,
                     21.34708643206803, 11.87928178855996,
                     22.399953773902862, 8.688591803471999,
                     23.43022805113112, 6.877522379978599,
                     24.757570596767465, 5.252025658622438,
                     26.412512579199163, 3.8574659601919046,
                     27.417903954191797, 3.1133601944289135,
                     27.976624335678746, 2.5301899281469065), ncol = 2, byrow = T)


# Getting the data ready to plot
R50JSDPlot.df = rbind(Mode, Disco, Planing, Adversary, CDOT)
R50JSDPlot.df = as.data.frame(R50JSDPlot.df)
colnames(R50JSDPlot.df) = c("R50", "JSD")
R50JSDPlot.df$Method = c(rep("Mode", nrow(Mode)),
                         rep("Disco", nrow(Disco)),
                         rep("Planing", nrow(Planing)),
                         rep("Adversary", nrow(Adversary)),
                         rep("CDOT", nrow(CDOT)))

# Saving data for future plots
#save(R50JSDPlot.df, file = "R50JSDPlotData.RData")
#load("R50JSDPlotData.RData")

# Plotting the data
p = ggplot(R50JSDPlot.df, aes(x = R50, y = JSD, color = Method)) +
  geom_point() +
  geom_line(linewidth = 0.85) +
  #scale_color_manual(values=c("#009292","#ff6db6", "#490092", "#b66dff", "#920000", "#db6d00")) +
  scale_color_manual(values = c("#009292", "#490092", "#b66dff", "#920000", "#db6d00")) +
  #lims(x = c(0,30), y = c(0,10000)) +
  scale_y_continuous(trans = 'log10') +
  ylab("1/JSD") +
  theme_bw()
ggsave(p, filename = "./cdot/img/R50JSDPlotFinal.png", height = 3, width = 6)


